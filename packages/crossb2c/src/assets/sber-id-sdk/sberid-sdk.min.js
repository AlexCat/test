/*! sberid-sdk - v2.3.2 - 2021-08-31
* Copyright (c) 2021 Сбер ID; Используя данное SDK вы соглашаетесь с Пользовательским соглашением, размещенным по адресу: https://www.sberbank.ru/common/img/uploaded/files/sberbank_id/agreement_sdk.pdf */
!function(a){"use strict";var b={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast","Opera Touch":"opera_touch",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},c={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",opera_touch:"Opera Touch",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},d={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e={messenger:"Facebook Messenger",facebook:"Facebook",twitter:"Twitter",line:"Line",wechat:"Wechat",instagram:"Instagram",electron:"Electron Application",outlook:"Microsoft Outlook",pinterest:"Pinterest App",thunderbird:"Thunderbird",webview:"Webview Based Browser",yaapp:"Yandex App"},f={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},g={invalid_request:"В запросе отсутствуют обязательные атрибуты",unauthorized_client:"АС - источник запроса не зарегистрирована или заблокирована в банке либо значение атрибута client_id не соответствует формату",unsupported_response_type:"Значение атрибута response_type не равно« code»",invalid_scope:"Значение атрибута scope не содержит параметр openid в начальной позиции либо запрошенный scope содержит значения, недоступные для АС - источника запроса",access_denied:"Клиент отказался от передачи согласий",invalid_state:"Значение атрибута state не соответствует изначальному",window_closed:"Клиент закрыл окно авторизации через Сбер ID"},h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=function(){function a(){}return a.getFirstMatch=function(a,b){var c=b.match(a);return c&&c.length>0&&c[1]||""},a.getSecondMatch=function(a,b){var c=b.match(a);return c&&c.length>1&&c[2]||""},a.map=function(a,b){var c=[];if(Array.prototype.map)return Array.prototype.map.call(a,b);for(var d=0;d<a.length;d+=1)c.push(b(a[d]));return c},a.find=function(a,b){if(Array.prototype.find)return Array.prototype.find.call(a,b);for(var c=0;c<a.length;c+=1){var d=a[c];if(b(d,c))return d}},a.getBrowserAlias=function(a){return b[a]},a.getBrowserTypeByAlias=function(a){return c[a]||""},a.getUrlSearchParams=function(a){var b=a?a.split("?")[1]||a:window.location.search.slice(1),c={};if(b){b=b.split("#")[0];for(var d=b.split("&"),e=0;e<d.length;e+=1){var f=d[e].split("="),g=f[0],h=void 0===f[1]||f[1];if(g.match(/\[(\d+)?\]$/)){var i=g.replace(/\[(\d+)?\]/,"");if(c[i]||(c[i]=[]),g.match(/\[\d+\]$/)){var j=/\[(\d+)\]/.exec(g)[1];c[i][j]=h}else c[i].push(h)}else c[g]?c[g]&&"string"==typeof c[g]?(c[g]=[c[g]],c[g].push(h)):c[g].push(h):c[g]=h}}return c},a.isOIDCRedirect=function(){var b=a.getUrlSearchParams();return(b.code||b.error)&&b.state},a.buildUrl=function(a,b){var c="";for(var d in b){c+=d+"="+b[d]+"&"}return c.length>0&&(c=c.substring(0,c.length-1)),a?a+"?"+c:c},a.isEncoded=function(a){return(a=a||"")!==decodeURIComponent(a)},a.generateRandom=function(b){var c=new Uint8Array(b);if("undefined"!=typeof window&&window.crypto)window.crypto.getRandomValues(c);else for(var d=0;d<b;d+=1)c[d]=Math.random()*h.length|0;return a.bufferToString(c)},a.bufferToString=function(a){for(var b=[],c=0;c<a.byteLength;c+=1){var d=a[c]%h.length;b.push(h[d])}return b.join("")},a.stringFormat=function(a,b){return"object"==typeof b&&void 0!==a?(Object.keys(b).forEach(function(c){a=a.replace(new RegExp(":"+c+":","g"),b[c])}),a):a},a.openDialog=function(a,b){var c={directories:"no",status:"no",menubar:"no",scrollbars:"yes",resizable:"no",width:600,height:600,centered:!0};if(b=b||{},Object.keys(c).forEach(function(a){b[a]=b.hasOwnProperty(a)?b[a]:c[a]}),b.centered){var d=void 0!==window.screenX?window.screenX:window.screenLeft,e=void 0!==window.screenY?window.screenY:window.screenTop,f=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,g=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,h=d<0?window.screen.width+d:d;b.left=parseInt(h+(f-b.width)/2,10),b.top=parseInt(e+(g-b.height)/2.5,10)}var i=window.open(a,"_blank",Object.keys(b).map(function(a){return a+"="+b[a]}).join(",")),j=[],k=setInterval(function(){i&&i.closed&&(clearInterval(k),j.forEach(function(a){a&&a()}))});return i&&(i.onclose=function(a){j.push(a)}),i},a.objToCss=function(a){return a?JSON.stringify(a,null,"\t").replace(/"/g,"").replace(/,\n/g,";").replace(/\}/g,"").replace(/\{/g,""):""},a.getMeta=function(a){const b=document.getElementsByTagName("meta");for(var c=0;c<b.length;c+=1)if(b[c].getAttribute("name")===a)return b[c].getAttribute("content");return""},a.createError=function(a,b,c,d){var e=new Error(a);return e.code=b,e.request=c,e.response=d,e},a.log=function(a,b){var b=b||"info",c={info:{color:"#0c5460",background:"#d1ecf1",border:"#bee5eb"},success:{color:"#155724",background:"#d4edda",border:"#c3e6cb"},error:{color:"#721c24",background:"#f8d7da",border:"#f5c6cb"}},d=new Date;console.info.apply(null,["["+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds().toString().padStart("0",2)+":"+d.getMilliseconds()+"] %c["+b+"]%c ","color: "+c[b].color+";background-color: "+c[b].background+";border: 1px solid "+c[b].border,""].concat(a))},a.sendRequest=function(b,c,d){var e=new XMLHttpRequest;e.withCredentials=!0,e.open("GET",b,!0),e.onreadystatechange=function(){if(e&&4===e.readyState&&(0!==e.status||e.responseURL&&0===e.responseURL.indexOf("file:"))){var b=e.responseText||e.response,f={};try{f=JSON.parse(b)}catch(a){f="string"==typeof b?b:{}}var g={data:f,status:e.status,statusText:e.statusText};g.status>=200&&g.status<300?c(g):d(a.createError("Request failed with status code "+g.status,e.status,e,g)),e=null}},e.onabort=function(){e&&(d(a.createError("Request aborted. ECONNABORTED",e.status,e,null)),e=null)},e.onerror=function(){d(a.createError("Network Error",null,e,null)),e=null},e.send()},a.fadeIn=function(a,b,c){var d=+new Date;a.style.opacity=0;var e=function(){a.style.opacity=+a.style.opacity+(new Date-d)/b,d=+new Date,+a.style.opacity<1?window.requestAnimationFrame&&requestAnimationFrame(e)||setTimeout(e,16):c&&"function"==typeof c&&c()};e()},a.fadeOut=function(a,b,c){var d=+new Date;a.style.opacity=1;var e=function(){a.style.opacity=+a.style.opacity-(new Date-d)/b,d=+new Date,+a.style.opacity>=0?window.requestAnimationFrame&&requestAnimationFrame(e)||setTimeout(e,16):c&&"function"==typeof c&&c()};e()},a.postMessage=function(a,b,c){c=c||"*",b&&b.postMessage(JSON.stringify(a),c)},a.postMessageToParent=function(b,c){a.postMessage(b,window.parent,c)},a.postMessageToIframe=function(b,c){a.postMessage(b,c)},a.listenWindowMessages=function(a){var b=function(b){var c;try{c=JSON.parse(b.data)}catch(a){return}a(c,b)};return window.addEventListener("message",b),function(){return window.removeEventListener("message",b)}},a.createIframe=function(a,b,c,d){b=b||"sberid-iframe";var e=document.createElement("iframe");return e.setAttribute("src",a),e.setAttribute("frameborder","0"),e.setAttribute("name",b),e.setAttribute("id",b),e.width="0",e.height="0",e.style.display="none",e.style.position="absolute",e.style.left="-9999px","function"==typeof c&&(e.onload=c),"function"==typeof d&&(e.onerror=d),e},a.getChangeUserPopupStyle=function(a,b,c){c=c||!1,a=a||"none",b=b||"#000014";var d={display:a,background:"#FFFFFF","box-shadow":"0px 12px 24px rgba(45, 73, 88, 0.15)","border-radius":"10px",position:"absolute","font-size":"15px","line-height":"27px",color:b,"white-space":"nowrap",padding:"15px 30px","font-weight":"bold","z-index":1};return c?(d.bottom="calc(100% - 10px)",d.right=0):d.top="calc(100% - 10px)",d},a.hideOnClickOutside=function(b,c){var d=function(d){!b.contains(d.target)&&a.isVisible(b)&&(c(),e())},e=function(){document.removeEventListener("click",d)};document.addEventListener("click",d)},a.isVisible=function(a){return!!a&&!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},a}(),j=function(){function a(){}return a.get=function(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0},a.set=function(a,b,c){c=c||{};var d=c.expires;if("number"==typeof d&&d){var e=new Date;e.setTime(e.getTime()+1e3*d),d=c.expires=e}d&&d.toUTCString&&(c.expires=d.toUTCString()),a=encodeURIComponent(String(a)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape),b=encodeURIComponent(String(b)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);var f=a+"="+b;for(var g in c)c[g]&&(f+="; "+g,!0!==c[g]&&(f+="="+c[g].split(";")[0]));document.cookie=f},a.delete=function(b){a.set(b,"",{expires:-1})},a}(),k=/version\/(\d+(\.?_?\d+)+)/i,l=[{test:[/googlebot/i],describe:function(a){var b={name:"Googlebot"},c=i.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/opera/i],describe:function(a){var b={name:"Opera"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/opr\/|opios/i],describe:function(a){var b={name:"Opera"},c=i.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/opt/i],describe:function(a){var b={name:"Opera Touch"},c=i.getFirstMatch(/(?:opt)[\s/](\S+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/SamsungBrowser/i],describe:function(a){var b={name:"Samsung Internet for Android"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/Whale/i],describe:function(a){var b={name:"NAVER Whale Browser"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/MZBrowser/i],describe:function(a){var b={name:"MZ Browser"},c=i.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/focus/i],describe:function(a){var b={name:"Focus"},c=i.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/swing/i],describe:function(a){var b={name:"Swing"},c=i.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/coast/i],describe:function(a){var b={name:"Opera Coast"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/yabrowser/i],describe:function(a){var b={name:"Yandex Browser"},c=i.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/ucbrowser/i],describe:function(a){var b={name:"UC Browser"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/Maxthon|mxios/i],describe:function(a){var b={name:"Maxthon"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/epiphany/i],describe:function(a){var b={name:"Epiphany"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/puffin/i],describe:function(a){var b={name:"Puffin"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/sleipnir/i],describe:function(a){var b={name:"Sleipnir"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/k-meleon/i],describe:function(a){var b={name:"K-Meleon"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/micromessenger/i],describe:function(a){var b={name:"WeChat"},c=i.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/msie|trident/i],describe:function(a){var b={name:"Internet Explorer"},c=i.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/\sedg\//i],describe:function(a){var b={name:"Microsoft Edge"},c=i.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/edg([ea]|ios)/i],describe:function(a){var b={name:"Microsoft Edge"},c=i.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/vivaldi/i],describe:function(a){var b={name:"Vivaldi"},c=i.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/seamonkey/i],describe:function(a){var b={name:"SeaMonkey"},c=i.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/sailfish/i],describe:function(a){var b={name:"Sailfish"},c=i.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,a);return c&&(b.version=c),b}},{test:[/silk/i],describe:function(a){var b={name:"Amazon Silk"},c=i.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/phantom/i],describe:function(a){var b={name:"PhantomJS"},c=i.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/slimerjs/i],describe:function(a){var b={name:"SlimerJS"},c=i.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var b={name:"BlackBerry"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var b={name:"WebOS Browser"},c=i.getFirstMatch(k,a)||i.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/bada/i],describe:function(a){var b={name:"Bada"},c=i.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/tizen/i],describe:function(a){var b={name:"Tizen"},c=i.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/qupzilla/i],describe:function(a){var b={name:"QupZilla"},c=i.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/firefox|iceweasel|fxios/i],describe:function(a){var b={name:"Firefox"},c=i.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/electron/i],describe:function(a){var b={name:"Electron"},c=i.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/chromium/i],describe:function(a){var b={name:"Chromium"},c=i.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,a)||i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/chrome|crios|crmo/i],describe:function(a){var b={name:"Chrome"},c=i.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:function(a){var b=!a.test(/like android/i),c=a.test(/android/i);return b&&c},describe:function(a){var b={name:"Android Browser"},c=i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/playstation 4/i],describe:function(a){var b={name:"PlayStation 4"},c=i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/safari|applewebkit/i],describe:function(a){var b={name:"Safari"},c=i.getFirstMatch(k,a);return c&&(b.version=c),b}},{test:[/.*/i],describe:function(a){var b=/^(.*)\/(.*) /,c=/^(.*)\/(.*)[ \t]\((.*)/,d=-1!==a.search("\\("),e=d?c:b;return{name:i.getFirstMatch(e,a),version:i.getSecondMatch(e,a)}}}],m=[{test:[/\bFB[\w_]+\/(Messenger|MESSENGER)/],describe:function(){return{name:e.messenger}}},{test:[/\bFB[\w_]+\//],describe:function(){return{name:e.facebook}}},{test:[/\bTwitter/i],describe:function(){return{name:e.twitter}}},{test:[/\bLine\//i],describe:function(){return{name:e.line}}},{test:[/\bMicroMessenger\//i],describe:function(){return{name:e.wechat}}},{test:[/\bInstagram/i],describe:function(a){return{name:e.instagram}}},{test:[/\bElectron/i],describe:function(){return{name:e.electron}}},{test:[/\bOutlook/i],describe:function(){return{name:e.outlook}}},{test:[/\bPinterest/i],describe:function(){return{name:e.pinterest}}},{test:[/\bThunderbird/i],describe:function(){return{name:e.thunderbird}}},{test:[/\bwebview/i,/; wv/],describe:function(){return{name:e.webview}}},{test:[/\bYaApp/i,/\bYandexSearch/i],describe:function(){return{name:e.yaapp}}}],n=[{test:[/Roku\/DVP/],describe:function(a){var b=i.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,a);return{name:f.Roku,version:b}}},{test:[/windows phone/i],describe:function(a){var b=i.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,a);return{name:f.WindowsPhone,version:b}}},{test:[/windows/i],describe:function(a){var b=i.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,a);return{name:f.Windows,version:b}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(a){var b={name:f.iOS},c=i.getSecondMatch(/(Version\/)(\d[\d.]+)/,a);return c&&(b.version=c),b}},{test:[/macintosh/i],describe:function(a){var b=i.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,a).replace(/[_\s]/g,".");return{name:f.MacOS,version:b}}},{test:[/(ipod|iphone|ipad)/i],describe:function(a){var b=i.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,a).replace(/[_\s]/g,".");return{name:f.iOS,version:b}}},{test:function(a){var b=!a.test(/like android/i),c=a.test(/android/i);return b&&c},describe:function(a){var b=i.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,a);return{name:f.Android,version:b}}},{test:[/(web|hpw)[o0]s/i],describe:function(a){var b=i.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,a),c={name:f.WebOS};return b&&b.length&&(c.version=b),c}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(a){var b=i.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,a)||i.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,a)||i.getFirstMatch(/\bbb(\d+)/i,a);return{name:f.BlackBerry,version:b}}},{test:[/bada/i],describe:function(a){var b=i.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,a);return{name:f.Bada,version:b}}},{test:[/tizen/i],describe:function(a){var b=i.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,a);return{name:f.Tizen,version:b}}},{test:[/linux/i],describe:function(){return{name:f.Linux}}},{test:[/CrOS/],describe:function(){return{name:f.ChromeOS}}},{test:[/PlayStation 4/],describe:function(a){var b=i.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,a);return{name:f.PlayStation4,version:b}}}],o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(a){var b=i.getFirstMatch(/(can-l01)/i,a)&&"Nova",c={type:d.mobile,vendor:"Huawei"};return b&&(c.model=b),c}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:d.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:d.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:d.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:d.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:d.tablet,vendor:"Amazon"}}},{test:[/tablet/i],describe:function(){return{type:d.tablet}}},{test:function(a){var b=a.test(/ipod|iphone/i),c=a.test(/like (ipod|iphone)/i);return b&&!c},describe:function(a){var b=i.getFirstMatch(/(ipod|iphone)/i,a);return{type:d.mobile,vendor:"Apple",model:b}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:d.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:d.mobile}}},{test:function(a){return"blackberry"===a.getBrowserName(!0)},describe:function(){return{type:d.mobile,vendor:"BlackBerry"}}},{test:function(a){return"bada"===a.getBrowserName(!0)},describe:function(){return{type:d.mobile}}},{test:function(a){return"windows phone"===a.getBrowserName()},describe:function(){return{type:d.mobile,vendor:"Microsoft"}}},{test:function(a){var b=Number(String(a.getOSVersion()).split(".")[0]);return"android"===a.getOSName(!0)&&b>=3},describe:function(){return{type:d.tablet}}},{test:function(a){return"android"===a.getOSName(!0)},describe:function(){return{type:d.mobile}}},{test:function(a){return"macos"===a.getOSName(!0)},describe:function(){return{type:d.desktop,vendor:"Apple"}}},{test:function(a){return"windows"===a.getOSName(!0)},describe:function(){return{type:d.desktop}}},{test:function(a){return"linux"===a.getOSName(!0)},describe:function(){return{type:d.desktop}}},{test:function(a){return"playstation 4"===a.getOSName(!0)},describe:function(){return{type:d.tv}}},{test:function(a){return"roku"===a.getOSName(!0)},describe:function(){return{type:d.tv}}}],p=function(){function a(a){if(void 0===a||null===a||""===a)throw new Error("UserAgent parameter can't be empty ");this._ua=a,this.parsedResult={},this.parse()}return a.prototype.getUA=function(){return this._ua},a.prototype.test=function(a){return a.test(this._ua)},a.prototype.parseBrowser=function(){var a=this;this.parsedResult.browser={};var b=i.find(l,function(b){if("function"==typeof b.test)return b.test(a);if(b.test instanceof Array)return b.test.some(function(b){return a.test(b)});throw new Error("Browser's test function is not valid")});return b&&(this.parsedResult.browser=b.describe(this.getUA())),this.parsedResult.browser},a.prototype.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},a.prototype.getBrowserName=function(a){return a?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},a.prototype.getBrowserVersion=function(){return this.getBrowser().version},a.prototype.parseOS=function(){var a=this;this.parsedResult.os={};var b=i.find(n,function(b){if("function"==typeof b.test)return b.test(a);if(b.test instanceof Array)return b.test.some(function(b){return a.test(b)});throw new Error("OS's test function is not valid")});return b&&(this.parsedResult.os=b.describe(this.getUA())),this.parsedResult.os},a.prototype.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},a.prototype.getOSName=function(a){var b=this.getOS().name;return a?String(b).toLowerCase()||"":b||""},a.prototype.getOSVersion=function(){return this.getOS().version},a.prototype.parseApp=function(){var a=this;this.parsedResult.app={};var b=i.find(m,function(b){if("function"==typeof b.test)return b.test(a);if(b.test instanceof Array)return b.test.some(function(b){return a.test(b)});throw new Error("Browser's test function is not valid")});return b&&(this.parsedResult.app=b.describe(this.getUA())),this.parsedResult.app},a.prototype.getApp=function(){return this.parsedResult.app?this.parsedResult.app:this.parseApp()},a.prototype.getAppName=function(a){return a?String(this.getApp().name).toLowerCase()||"":this.getApp().name||""},a.prototype.parsePlatform=function(){var a=this;this.parsedResult.platform={};var b=i.find(o,function(b){if("function"==typeof b.test)return b.test(a);if(b.test instanceof Array)return b.test.some(function(b){return a.test(b)});throw new Error("Platform's test function is not valid")});return b&&(this.parsedResult.platform=b.describe(this.getUA())),this.parsedResult.platform},a.prototype.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},a.prototype.getPlatformType=function(a){var b=this.getPlatform().type;return a?String(b).toLowerCase()||"":b||""},a.prototype.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseApp(),this},a.prototype.getResult=function(){return Object.assign({},this.parsedResult)},a}(),q=function(){function a(){}return a.getParser=function(a,b){if("string"!=typeof a)throw new Error("UserAgent should be a string");return new p(a)},a.parse=function(a){return new p(a).getResult()},a}(),r=function(){function a(){this._browsingInIncognitoMode=void 0}return a.prototype.getBrowsingMode=function(){return this._browsingInIncognitoMode},a.prototype.browsingInIncognitoMode=function(){this._browsingInIncognitoMode=!0},a.prototype.browsingInNormalMode=function(){this._browsingInIncognitoMode=!1},a.prototype.run=function(a){var b=this;(new s).browser(this).detectBrowsingMode(),this.retry(function(){return void 0!==b._browsingInIncognitoMode},function(){a(b._browsingInIncognitoMode)})},a.prototype.retry=function(a,b){var c=0,d=50,e=10,f=!1,g=window.setInterval(function(){a()&&(window.clearInterval(g),b(f)),c++>d&&(window.clearInterval(g),f=!0,b(f))},e)},a}(),s=function(){function a(){this._browser=void 0}return a.prototype.browser=function(a){return"object"==typeof this._browser?this._browser:(this._browser=this._resolve(a),this._browser)},a.prototype._resolve=function(a){var b=q.getParser(window.navigator.userAgent).getBrowserName(!0);return"safari"===b?new w(a):"firefox"===b?new u(a):window.requestFileSystem||window.webkitRequestFileSystem?new t(a):window.PointerEvent||window.MSPointerEvent?new v(a):new x(a)},a}(),t=function(a){var b=this;return this.STORAGE_QUOTA_LIMIT=12e7,this.TEMP_STORAGE_QUOTA_LIMIT=11e7,this.BrowsingModeDetector=a,this.detectBrowsingMode=function(){var a=function(){b.BrowsingModeDetector.browsingInNormalMode()},c=function(){b.BrowsingModeDetector.browsingInIncognitoMode()},d=function(){void 0!==navigator.webkitTemporaryStorage&&void 0!==navigator.webkitTemporaryStorage.queryUsageAndQuota?navigator.webkitTemporaryStorage.queryUsageAndQuota(function(d,e){e<b.TEMP_STORAGE_QUOTA_LIMIT?c():a()},function(){a()}):a()},e=function(){d()},f=function(){b.BrowsingModeDetector.browsingInIncognitoMode()};!function(){void 0!==navigator.storage&&void 0!==navigator.storage.estimate?navigator.storage.estimate().then(function(a){a.quota<b.STORAGE_QUOTA_LIMIT?f():e()}):e()}()},this},u=function(a){return this.BrowsingModeDetector=a,this.detectBrowsingMode=function(){var a,b=this,c=function(c){void 0===b.BrowsingModeDetector.getBrowsingMode()&&b.BrowsingModeDetector.retry(function(){return"done"===a.readyState},function(e){if(e)return d(c);a.result&&b.BrowsingModeDetector.browsingInNormalMode()})},d=function(a){b.BrowsingModeDetector.browsingInIncognitoMode()};a=indexedDB.open("i"),a.onsuccess=c,a.onerror=d},this},v=function(a){return this.BrowsingModeDetector=a,this.detectBrowsingMode=function(){this.BrowsingModeDetector.browsingInNormalMode();try{window.indexedDB||this.BrowsingModeDetector.browsingInIncognitoMode()}catch(a){this.BrowsingModeDetector.browsingInIncognitoMode()}},this},w=function(a){function b(a){var b=a/4,c=new Array(b+1).join("aあ"),d={size:a,payload:c};d.lastModifiedDate=new Date,d.name=1e5+~~(1e5*Math.random())+".txt";try{localStorage.setItem(d.name,JSON.stringify(d))}catch(a){try{localStorage.removeItem(d.name)}catch(a){}return!1}try{localStorage.removeItem(d.name)}catch(a){}return!0}return this.BrowsingModeDetector=a,this.detectBrowsingMode=function(){var a=parseInt(q.getParser(window.navigator.userAgent).getOSVersion().split(".")[0],10)||0,c=parseInt(q.getParser(window.navigator.userAgent).getBrowserVersion().split(".")[0],10)||0,d=q.getParser(window.navigator.userAgent).getOSName(!0);if(window.safariIncognito||!navigator.cookieEnabled)return void this.BrowsingModeDetector.browsingInIncognitoMode();try{window.openDatabase(null,null,null,null),window.localStorage.setItem("test",1)}catch(a){this.BrowsingModeDetector.browsingInIncognitoMode()}if(void 0===this.BrowsingModeDetector.getBrowsingMode())if(window.localStorage.removeItem("test"),"ios"===d&&a>=14||"macos"===d&&c>=14)this.BrowsingModeDetector.browsingInNormalMode();else{var e=5242880;b(e)?this.BrowsingModeDetector.browsingInIncognitoMode():this.BrowsingModeDetector.browsingInNormalMode()}},this},x=function(a){this.BrowsingModeDetector=a,this.detectBrowsingMode=function(){this.BrowsingModeDetector.browsingInNormalMode()}},y=function(){function a(a){this._config=a||{},this._params={},void 0===this._config.needAdditionalRedirect&&(this._config.needAdditionalRedirect=!0),this._config.params&&(this._params=i.getUrlSearchParams(this._config.params)),this.redirect={android:{chrome:"com.android.chrome",yandex:"com.yandex.browser",opera:"com.opera.browser",firefox:"org.mozilla.firefox",samsung_internet:"com.sec.android.app.sbrowser"},ios:{chrome:{https:"googlechromes://",http:"googlechrome://"},yandex:{https:"yandexbrowser-open-url://https://",http:"yandexbrowser-open-url://http://"},opera_touch:{https:"touch-https://",http:"touch-http://"},firefox:{https:"firefox://open-url%3Furl%3Dhttps%3A%2F%2F",http:"firefox://open-url%3Furl%3Dhttp%3A%2F%2F"}}},this.universalLinkUrl=a.universalLinkUrl||"https://online.sberbank.ru/CSAFront/oidc/sberbank_id/authorize.do",this.baseUrl=a.baseUrl||"https://online.sberbank.ru/CSAFront/oidc/authorize.do",this.deeplinkUrl=a.deeplinkUrl||"sberbankidlogin://sberbankidsso",this.init()}return a.prototype.isAllowedBrowser=function(a){return-1!==["chrome","yandex","firefox","samsung_internet","opera","opera_touch"].indexOf(a)},a.prototype.setAddionalRedirect=function(a,b){var c="https",d=i.isEncoded(this._params.redirect_uri)?decodeURIComponent(this._params.redirect_uri):this._params.redirect_uri;d&&(c=d.indexOf("https://")?"https":"http"),this.redirect.hasOwnProperty(a)&&this.redirect[a].hasOwnProperty(b)&&("android"===a?this._params.package=this.redirect[a][b]:"ios"===a&&(this._params.ext_redirect_uri=this.redirect[a][b][c]+(d||"").replace(/^https?:\/\//,"")))},a.prototype.browsingModeDetectorCallback=function(a){var b=!1,c=q.getParser(window.navigator.userAgent),d=c.getResult(),e=i.getBrowserAlias(c.getBrowserName());this._config.needAdditionalRedirect&&this.setAddionalRedirect(c.getOSName(!0),e),a||d.app.name||("ios"===c.getOSName(!0)?("safari"===e||this.isAllowedBrowser(e)&&this._config.needAdditionalRedirect)&&(b=!0):b=!("android"!==c.getOSName(!0)||!this.isAllowedBrowser(e)));var f=i.buildUrl(this.deeplinkUrl,this._params),g=i.buildUrl(b?this.universalLinkUrl:this.baseUrl,this._params),h={isPrivate:a,isUniversalLink:b,isWebview:!!d.app.name,os:c.getOSName(!0),browser:e,link:g,deeplink:f,universalLinkUrl:this.universalLinkUrl,defaultLinkUrl:this.baseUrl,deeplinkUrl:this.deeplinkUrl,oidc:this._params};if(this._config.selector){var j=document.querySelectorAll(this._config.selector);if(j.length>0)for(var k=0;k<j.length;k+=1)j[k].setAttribute("href",g)}if(this._config.formSelector){var l=document.querySelectorAll(this._config.formSelector);if(l.length>0)for(var k=0;k<l.length;k+=1)l[k].setAttribute("value",b)}this._config.callback&&"function"==typeof this._config.callback&&this._config.callback(h)},a.prototype.init=function(){this._browsingModeDetector=new r;try{this._browsingModeDetector.run(this.browsingModeDetectorCallback.bind(this))}catch(a){this.browsingModeDetectorCallback(!1)}},a}(),z=function(){function a(a,b,c){var d="da8570065d949a8a3ee551b99f31f7774909575e702289b2743fab0aad0ffe41";this.BUTTON_TEXT={default:{anonymous:"Войти по Сбер ID",personal:"Войти как #userName#"},resume:{anonymous:"Продолжить со Сбер ID",personal:"Продолжить как #userName#"},login:{anonymous:"Сбер ID",
personal:"Войти как #userName#"},fill:{anonymous:"Заполнить со Сбер ID",personal:"Войти как #userName#"}},this.BUTTON_THEME={default:{backgroundColor:"#21A038",borderColor:"#21A038",color:"#fff",fill:"#fff",borderRadius:4},white:{backgroundColor:"#fff",borderColor:"#767676",color:"#000000",fill:"#21A038",borderRadius:4}},this.BUTTON_SIZE={default:{padding:22,fontSize:16,lineHeight:19,height:48},small:{padding:16,fontSize:14,lineHeight:16,height:32},long:{padding:26,fontSize:16,lineHeight:19,height:64}},this.VERSION="2.3.2",this.sbButtons=[],this.notification=null,this.user={},this.oidcParams={},this.onSuccessCallback=b,this.onErrorCallback=c,this.parser=q.getParser(window.navigator.userAgent),this.mergeTheme(a);var e=Object.assign({},{url:"https://sa.online.sberbank.ru:8098/metrics/partners",init:"none",enable:!1},a.sa||{});this.config.sa=Object.assign({},e);var f=Object.assign({},{autoCloseDelay:90,autoClose:!0,enable:!1,animation:!0,offset:{top:30,bottom:30,left:30,right:30}},a.notification||{},{position:this.getNotificationBannerDefaultPosition(a.notification&&a.notification.position)});this.config.notification=Object.assign({},f);var g=Object.assign({},{enable:!1,changeUser:!1,mode:"default",timeout:1e3},a.fastLogin||{});if(this.config.fastLogin=Object.assign({},g),this.config.sa.enable){var h=this.config.oidc&&this.config.oidc.client_id||this.config.sa.clientId||"",j={url:this.config.sa.url,buffer:1,apiKey:d,sberId:h,subId:""};"auto"===this.config.sa.init&&this.initSberAnalytics(j)}var k=Object.assign({},{enable:!0,allowSberIDRedirects:[],mode:"default"},a.deeplink||{});this.config.deeplink=Object.assign({},k),this.config.debug&&(i.log(["Инициализируем SDK"],"info"),i.log(["Параметры инициализации: ",this.config],"info")),this.proxyParams=["authApp","app_redirect_uri"],this.config.utmProxyDisabled||(this.proxyParams=this.proxyParams.concat(["utm_source","utm_medium","utm_campaign","utm_term","utm_content"])),this.config.deeplink.enable,this.isFastLoginIframeRegistered=!1,this.isFastLoginDataFetched=!1,this.fastLoginIframe=null,this.onInit()}return a.prototype.onInit=function(){if(this.config.selector)this.sbButtons=document.getElementsByClassName(this.config.selector),this.setOIDCParams(this.sbButton.getAttribute("href"));else{if(this.config.container){var a=[];a=this.config.container instanceof HTMLDivElement?a.concat(this.config.container):document.getElementsByClassName(this.config.container);for(var b=0;b<a.length;b+=1){var c=this.createButton(this.config.personalization,b);this.sbButtons.push(c),a[b].appendChild(c)}}this.config.notification.enable&&this.setNotificationBanner(),this.setOIDCParams(this.config.oidc),this.config.sa.enable&&this.submitSberAnalytics("Login","sberid_Login_Show","Show","","",this.config.style),this.config.personalization&&this.getUser()}if("popup"===this.config.display&&"desktop"===this.parser.getPlatformType(!0)||this.config.fastLogin.enable)for(var b=0;b<this.sbButtons.length;b+=1)this.addEventListener(this.sbButtons[b]);if(this.config.sa.enable)for(var d=this,b=0;b<d.sbButtons.length;b+=1)this.sbButtons[b].addEventListener("click",function(){this.parentElement&&"i-sbid-notification-banner"===this.parentElement.id?d.submitSberAnalytics("Login","sberid_Banner_Login_Button_Click","Click"):d.submitSberAnalytics("Login","sberid_Login_Button_Click","Click")})},a.prototype.getButtonSize=function(){var a={},b=document.createElement("div"),c=this.createButton(),d=document.getElementsByTagName("body")[0];return b.className="sbid-check-button-container",b.id="i-sbid-check-button-container",b.setAttribute("style","position: fixed; left: -9999px"),b.appendChild(c),d.appendChild(b),a=c.getBoundingClientRect(),b.remove(),a},a.prototype.checkButtonSize=function(a,b){if(this.config.container){for(var c=document.getElementsByClassName(this.config.container),d=b?24:0,e=0;e<c.length;e+=1)if(a.width+d>=(c[e].getBoundingClientRect()||{}).width)return!1;return!0}return!1},a.prototype.getUser=function(){this.setButtonLoader();var a=(this.config.baseUrl||"https://online.sberbank.ru")+"/CSAFront/api/oidc/sbid?client_id="+this.oidcParams.client_id;this.config.debug&&i.log(["Получаем информацию о пользователе"],"info"),i.sendRequest(a,this.onGetUserSuccess.bind(this),this.onGetUserError.bind(this))},a.prototype.onGetUserSuccess=function(a){this.user=Object.assign({},a.data),this.config.debug&&i.log(["Данные о пользователе получены",a],"success"),this.notification&&this.showNotificationBanner(),this.config.fastLogin.enable&&"auto"===this.config.fastLogin.mode&&(this.setButtonLoader(),this.fastLogin(function(a){this.config.debug&&i.log(["Успешный быстрый вход",a],"success"),this.destroyFastLogin(),this.onSuccessCallback(a.data),this.removeButtonLoader(),this.onNotificationBannerClose()}.bind(this),function(a){this.config.debug&&i.log(["Автоматический вход не удался",a],"error")}.bind(this))),this.setButtonText(),this.removeButtonLoader()},a.prototype.onGetUserError=function(a){this.config.debug&&i.log(["Ошибка при получении данных о пользователе",a],"error"),this.removeButtonLoader()},a.prototype.changeUser=function(a){this.setButtonLoader();var b=(this.config.baseUrl||"https://online.sberbank.ru")+"/CSAFront/api/oidc/sbid/reset?client_id="+this.oidcParams.client_id,c=this;this.config.debug&&i.log(["Сбрасываем информацию о пользователе"],"info"),i.sendRequest(b,this.onResetUserSuccess.bind(this),function(b){if(c.config.debug&&i.log(["Ошибка при удаление данных о пользователе",b],"error"),a&&a.parentElement){var d=(a.parentElement.getElementsByClassName("sbid-button-change-user__popup")||[])[0];(a.parentElement.getElementsByClassName("sbid-button-change-user__error")||[])[0]||a.parentElement.appendChild(c.getChangeUserErrorBlock()),d&&"true"===a.parentElement.dataset.opened&&d.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle()))}c.submitSberAnalytics("Login","sberid_Change_User_Result","Result","fail"),c.removeButtonLoader()})},a.prototype.onResetUserSuccess=function(a){this.user={},this.config.debug&&i.log(["Данные о пользователе удалены",a],"success"),this.submitSberAnalytics("Login","sberid_Change_User_Result","Result","success"),this.notification&&this.hideNotificationBanner(),this.setButtonText(),this.removeButtonLoader()},a.prototype.getNotificationBannerCookieExpires=function(a){var b=[7200,86400,604800,2419200],c=a||0;return a>=b.length&&(c=b.length-1),b[c]},a.prototype.getNotificationBannerDefaultPosition=function(a){var b="bottom-right";switch(a){case"left":b="bottom-left";break;case"right":b="bottom-right"}return b=-1!==["bottom-left","bottom-right","top-left","top-right"].indexOf(a)?a:b},a.prototype.onNotificationBannerClose=function(){this.notification&&(this.hideNotificationBanner(),this.submitSberAnalytics("Login","sberid_Notification_Banner_Close","Close","success"));var a=+j.get("sbid_notification_banner_close_count")||0;j.set("sbid_notification_banner_closed",1,{path:"/",expires:this.getNotificationBannerCookieExpires(a)});var b=new Date;j.set("sbid_notification_banner_close_count",a+1,{path:"/",expires:new Date(b.getFullYear()+1,b.getMonth(),b.getDate())}),this.config.notification.onNotificationBannerClose&&"function"==typeof this.config.notification.onNotificationBannerClose&&this.config.notification.onNotificationBannerClose()},a.prototype.hideNotificationBanner=function(){if(this.notification){var a=this,b=this.config.notification.animation?500:12;i.fadeOut(this.notification,b,function(){a.notification.remove()})}},a.prototype.showNotificationBanner=function(){var a=this.config.notification.animation?500:12;this.notification.setAttribute("style",i.objToCss(this.getNotificationBannerStyle(!0))),i.fadeIn(this.notification,a);var b="mobile"===this.parser.getPlatformType(!0);this.submitSberAnalytics("Login","sberid_Notification_Banner_Show","Show","success"),b&&this.config.notification.autoClose&&(this.config.debug&&i.log("Баннер будет скрыт через "+this.config.notification.autoCloseDelay+" секунд."),setTimeout(this.onNotificationBannerClose.bind(this),1e3*this.config.notification.autoCloseDelay)),this.config.notification.onNotificationBannerOpen&&"function"==typeof this.config.notification.onNotificationBannerOpen&&this.config.notification.onNotificationBannerOpen()},a.prototype.setNotificationBanner=function(){if(1!=+j.get("sbid_notification_banner_closed")){var a=document.getElementsByTagName("body")[0],b=this.createButton(this.config.personalization,this.sbButtons.length),c=document.createElement("div"),d=document.createElement("div");d.innerHTML="Вход по Сбер ID",d.className="sbid-notification-banner__label",d.setAttribute("style","font-size: 15px; line-height: 18px; color: #767676;margin-bottom: 16px;font-weight: 600;"),c.appendChild(d);var e=document.createElement("a");e.innerHTML='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 4.65094L10.3675 0.282877C10.7431 -0.0927631 11.3485 -0.0942703 11.721 0.27826C12.0961 0.653395 12.0914 1.25686 11.7164 1.63195L7.34886 6L11.7164 10.368C12.0914 10.7431 12.0961 11.3466 11.721 11.7217C11.3485 12.0943 10.7431 12.0928 10.3675 11.7171L6 7.34906L1.63247 11.7171C1.25688 12.0928 0.651469 12.0943 0.278986 11.7217C-0.0960822 11.3466 -0.0914182 10.7431 0.283602 10.368L4.65114 6L0.283602 1.63195C-0.0914182 1.25686 -0.0960822 0.653395 0.278986 0.27826C0.651469 -0.0942703 1.25688 -0.0927631 1.63247 0.282877L6 4.65094Z" fill="#767676"/></svg>',e.className="sbid-notification-banner__close",e.setAttribute("style","font-size: 0; line-height: 12px; color: #767676;position: absolute;right: 10px;top: 10px;cursor: pointer;display: flex;padding: 10px"),c.appendChild(e),e.addEventListener("click",this.onNotificationBannerClose.bind(this)),c.className="sbid-notification-banner",c.id="i-sbid-notification-banner",c.setAttribute("style",i.objToCss(this.getNotificationBannerStyle())),c.appendChild(b),a.appendChild(c),this.sbButtons.push(b),c.appendChild(b),this.notification=c}},a.prototype.getVersion=function(){return this.VERSION},a.prototype.addEventListener=function(a){var b=this;this.w=void 0,a.addEventListener("click",function(c){if(c.preventDefault(),"true"===this.getAttribute("disabled"))return!1;var d=a.getAttribute("href");return b.setButtonLoader(),b.config.fastLogin.enable?b.fastLogin(function(a){b.config.debug&&i.log(["Успешный быстрый вход",a],"success"),b.destroyFastLogin(),b.onSuccessCallback(a.data),b.removeButtonLoader(),b.onNotificationBannerClose()},function(a){b.removeButtonLoader(),b.destroyFastLogin(),b.config.debug&&i.log(["Ошибка быстрого входа",a],"error"),"popup"===b.config.display&&"desktop"===b.parser.getPlatformType(!0)?(b.w=b.openDialog(d,b.closeCallback.bind(b)),b.windowStatus="opened"):window.location.href=d}):"popup"===b.config.display&&"desktop"===b.parser.getPlatformType(!0)?(b.w=b.openDialog(d,b.closeCallback.bind(b)),b.windowStatus="opened"):window.location.href=d,!1}),window.addEventListener?window.addEventListener("message",b.listener.bind(b)):window.attachEvent("onmessage",b.listener.bind(b))},a.prototype.setOIDCParams=function(a){a=a||"","string"==typeof a&&(a=i.getUrlSearchParams(a)),a.redirect_uri&&!i.isEncoded(a.redirect_uri)&&(a.redirect_uri=encodeURIComponent(a.redirect_uri)),a.app_redirect_uri&&!i.isEncoded(a.app_redirect_uri)&&(a.app_redirect_uri=encodeURIComponent(a.app_redirect_uri));for(var b={display:this.config.display||"page"},c=i.getUrlSearchParams(),d=Object.keys(c),e=0;e<d.length;e+=1)-1!==this.proxyParams.indexOf(d[e])&&(b[d[e]]=c[d[e]]);var f=-1!==d.indexOf("app_redirect_uri")||-1!==d.indexOf("authApp")||"false"===c.is_universal_link;if(this.config.debug&&i.log(["Проксируем дополнительные параметры: ",b]),this.config.generateState&&"popup"===this.config.display&&!i.isOIDCRedirect()){var g=this.generateState();j.set("sbid_state",g,{path:"/"}),b.state=g}this.oidcParams=Object.assign({},a,b)||{};var h=i.buildUrl("",this.oidcParams),k="mobile"===this.parser.getPlatformType(!0),l=(this.config.universallink||{}).baseUrl||"https://online.sberbank.ru/CSAFront/oidc/authorize.do";if(k&&this.config.deeplink.enable&&c.sberIDRedirect){var m=decodeURIComponent(c.sberIDRedirect);(this.config.deeplink.allowSberIDRedirects.length>0&&-1!==this.config.deeplink.allowSberIDRedirects.indexOf(m)||0===this.config.deeplink.allowSberIDRedirects.length)&&(l=m,f=!0,"auto"===this.config.deeplink.mode?(this.config.debug&&i.log(["Автоматический переход по deeplink: ",l+"?"+h]),window.location.href=l+"?"+h):this.config.debug&&i.log(["Будет осуществлен переход по deeplink: ",l+"?"+h]))}this.config.mweb2app&&!f?new y(Object.assign({},this.config.universallink||{},{params:h,callback:this.sbUniversallinkCallback.bind(this)})):this.sbUniversallinkCallback({isUniversalLink:!1,link:l+"?"+h})},a.prototype.hasUser=function(){return this.user.firstname||this.user.partname||this.user.surname},a.prototype.getButtonText=function(a,b){if(a&&this.hasUser()){var c=[];return this.user.firstname&&c.push(this.user.firstname),this.user.surname&&c.push(this.user.surname),this.BUTTON_TEXT[b].personal.replace("#userName#",c.join(" "))}return this.BUTTON_TEXT[b].anonymous},a.prototype.mergeTheme=function(a){var b={"font-family":"SB Sans, Roboto, San Francisco, sans-serif","font-weight":400};a.style&&a.style.custom&&(b=Object.assign({},b,a.style.custom),b.height<28&&(b.height=28),b.height>64&&(b.height=64));var c=Object.assign({},{theme:"default",text:"default",size:"default",custom:b},a.style||{});-1===Object.keys(this.BUTTON_THEME).indexOf(c.theme)&&(c.theme="default"),-1===Object.keys(this.BUTTON_TEXT).indexOf(c.text)&&(c.text="default"),-1===Object.keys(this.BUTTON_SIZE).indexOf(c.size)&&(c.text="default"),this.config=Object.assign({},a,{style:c}),"internet explorer"===this.parser.getBrowserName(!0)&&this.config.display,this.theme=Object.assign({},this.BUTTON_THEME[this.config.style.theme],this.BUTTON_SIZE[this.config.style.size],b)},a.prototype.generateState=function(){return i.generateRandom(43)},a.prototype.sbUniversallinkCallback=function(a){for(var b=0;b<this.sbButtons.length;b+=1)this.sbButtons[b].setAttribute("href",a.link)},a.prototype.checkState=function(a){var b=j.get("sbid_state");return!a||b===a||(this.w&&(this.windowStatus="closed",this.w.close()),"function"==typeof this.onErrorCallback&&this.onErrorCallback({code:"error",error:"invalid_state",description:g.invalid_state}),j.delete("sbid_state"),!1)},a.prototype.listener=function(a){var b={};try{b=JSON.parse(a.data)}catch(b){this.config.debug&&i.log(["Ошибка при обработке postMessage",a.data],"info")}if((!this.config.generateState||this.checkState(b.state))&&b&&("success"===b.status||"error"===b.status)&&(this.w&&(this.windowStatus="closed",this.w.close()),"success"===b.status&&"function"==typeof this.onSuccessCallback&&(this.config.sa.enable&&this.submitSberAnalytics("Login","sberid_Login_Auth_Result","Result","success"),this.onSuccessCallback(b)),"error"===b.status&&"function"==typeof this.onErrorCallback)){if(this.config.sa.enable){var c=b.error+"_"+b.description;this.submitSberAnalytics("Login","sberid_Login_Auth_Result","Result","fail",c)}this.onErrorCallback(b)}},a.prototype.getLogoStyle=function(){var a={logoHeight:"16px",logoWidth:"16px",logoFill:this.BUTTON_THEME[this.config.style.theme].fill};return this.theme.height>=34&&(a.logoWidth="22px",a.logoHeight="22px"),this.theme.height>=50&&(a.logoWidth="26px",a.logoHeight="26px"),a},a.prototype.getTextStyle=function(){var a={"font-family":this.theme["font-family"]||"Roboto","font-weight":this.theme["font-weight"]||400,"text-decoration":"none",color:this.theme.color,"font-size":"14px","margin-left":"8px"};return this.theme.height>=32&&(a["font-size"]="16px"),a},a.prototype.getButtonStyle=function(){var a={"text-decoration":"none",height:this.theme.height-2+"px","background-color":this.theme.backgroundColor,display:"inline-flex","align-items":"center",padding:"0 "+this.theme.padding+"px 0 "+this.theme.padding+"px","justify-content":"center","border-radius":this.theme.borderRadius+"px",border:"1px solid "+this.theme.borderColor,"box-shadow":this.theme["box-shadow"]||"none",position:"relative"};return"long"===this.config.style.size&&(a.display="flex"),a},a.prototype.getNotificationBannerStyle=function(a){var b="mobile"===this.parser.getPlatformType(!0),c={position:"fixed",background:"#fff",border:"1px solid #E3E3E3","box-shadow":"0px 10px 24px rgba(45, 73, 88, 0.15)","border-radius":b?0:"5px",padding:"20px",display:"none",width:b?"100%":"auto","box-sizing":"border-box","flex-direction":"column","font-family":"SB Sans, Roboto, sans-serif","min-width":"320px",opacity:0};return-1!==["bottom-left","top-left"].indexOf(this.config.notification.position)&&(c.left=b?0:this.config.notification.offset.left+"px"),-1!==["bottom-right","top-right"].indexOf(this.config.notification.position)&&(c.right=b?0:this.config.notification.offset.right+"px"),-1!==["bottom-right","bottom-left"].indexOf(this.config.notification.position)&&(c.bottom=b?0:this.config.notification.offset.bottom+"px"),-1!==["top-right","top-left"].indexOf(this.config.notification.position)&&(c.top=b?0:this.config.notification.offset.top+"px"),a&&(c.display="flex"),c},a.prototype.createButton=function(a,b){void 0===a&&(a=this.config.personalization);var c=document.createElement("a");return c.className="sbid-button sbid-button--theme-"+this.config.style.theme+" sbid-button--size-"+this.config.style.size,c.id="i-sbid-button-"+b,c.setAttribute("style",i.objToCss(this.getButtonStyle())),c.innerHTML=i.stringFormat('<span class="sbid-button__logo"><svg style="display: block" width=":logoWidth:" height=":logoHeight:" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 0C16.0927 0 18.9337 1.08103 21.1657 2.88421L18.6371 4.74793C17.0315 3.64848 15.0899 3.00354 13 3.00354C7.48924 3.00354 3.00587 7.48999 3.00587 13.0013C3.00587 18.5126 7.48924 22.9965 13 22.9965C18.5134 22.9965 22.9968 18.5126 22.9968 13.0013C22.9968 12.9118 22.9941 12.8223 22.9924 12.7328L25.7912 10.6699C25.9289 11.4245 26 12.2055 26 13.0013C26 20.1807 20.1795 26 13 26C5.82135 26 0 20.1807 0 13.0013C0 5.81931 5.82135 0 13 0ZM23.2856 5.05241C23.9006 5.84651 24.4262 6.71169 24.8456 7.63565L13.0002 16.3673L8.05093 13.2628V9.52921L13.0002 12.6337L23.2856 5.05241Z" fill=":logoFill:"/></svg></span><span style=":textStyle:" class="sbid-button__text">:text:</span>',Object.assign({text:this.getButtonText(a,this.config.style.text),textStyle:i.objToCss(this.getTextStyle())},this.getLogoStyle())),c},a.prototype.setButtonText=function(a){var b=this.getButtonSize();void 0===a&&(a=this.config.personalization),this.checkButtonSize(b,this.config.fastLogin.changeUser)||(a=!1);for(var c=0;c<this.sbButtons.length;c+=1)if(this.sbButtons[c].parentElement&&"i-sbid-notification-banner"===this.sbButtons[c].parentElement.id){if(this.config.personalization&&(this.sbButtons[c].setAttribute("data-fastlogin",!0),this.config.fastLogin.changeUser)){const d=this.sbButtons[c].querySelector(".sbid-button-change-user");this.hasUser()&&!d?this.sbButtons[c].appendChild(this.createChangeUserBlock(!0)):this.hasUser()||d.parentNode.removeChild(d)}this.sbButtons[c].querySelector(".sbid-button__text").innerHTML=this.getButtonText(this.config.personalization,"resume"),this.sbButtons[c].setAttribute("style",i.objToCss(this.getButtonStyle(this.config.personalization&&this.config.fastLogin.changeUser)))}else{if(a&&(this.sbButtons[c].setAttribute("data-fastlogin",!0),this.config.fastLogin.changeUser)){var d=this.sbButtons[c].querySelector(".sbid-button-change-user");this.hasUser()&&!d?this.sbButtons[c].appendChild(this.createChangeUserBlock()):this.hasUser()||d.parentNode.removeChild(d)}this.sbButtons[c].querySelector(".sbid-button__text").innerHTML=this.getButtonText(a,this.config.style.text),this.sbButtons[c].setAttribute("style",i.objToCss(this.getButtonStyle(a&&this.config.fastLogin.changeUser)))}},a.prototype.setButtonLoader=function(){var a="22px",b=document.createElement("span"),c={height:"100%",width:"100%","background-color":this.theme.backgroundColor,display:"flex","align-items":"center","justify-content":"center","border-radius":this.theme.borderRadius+"px",position:"absolute"};this.theme.height>=34&&(a="28px"),this.theme.height>=50&&(a="36px"),b.className="sbid-button-loader",b.setAttribute("style",i.objToCss(c)),b.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+a+'" height="'+a+'" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path opacity="0.2" fill="#fff" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"/><path fill="#fff" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20" dur="0.5s" repeatCount="indefinite"/></path></svg>';for(var d=0;d<this.sbButtons.length;d+=1)this.sbButtons[d].setAttribute("disabled",!0),this.sbButtons[d].appendChild(b.cloneNode(!0))},a.prototype.removeButtonLoader=function(){for(var a=document.getElementsByClassName("sbid-button-loader"),b=0;b<this.sbButtons.length;b+=1)this.sbButtons[b].setAttribute("disabled",!1);for(;a.length>0;)a[0].parentNode.removeChild(a[0])},a.prototype.openDialog=function(a,b,c){var d=i.openDialog(a,c),e=setInterval(function(){d&&!d.closed||(clearInterval(e),b&&b())},100);return d},a.prototype.closeCallback=function(){if("closed"!==this.windowStatus&&(this.windowStatus="closed","function"==typeof this.onErrorCallback)){if(this.config.sa.enable){var a="window_closed_"+g.window_closed;this.submitSberAnalytics("Login","sberid_Login_Auth_Result","Result","fail",a)}this.removeButtonLoader(),this.onErrorCallback({code:"error",error:"window_closed",description:g.window_closed})}},a.prototype.successWindowListener=function(){var a=i.getUrlSearchParams();if(window.opener&&(a.code||a.error)){this.removeButtonLoader();var a=i.getUrlSearchParams(),b=Object.assign({status:"success"},a);b.error&&(b.status="error",b.description=g[b.code]||"Что-то пошло не так");try{window.opener.postMessage(JSON.stringify(Object.assign(b,a)),window.opener.location.href)}catch(a){this.config.debug&&i.log(["Ошибка в листенере закрытия окна: ",a])}}},a.prototype.initSberAnalytics=function(a){try{window.sberbankIdAnalytics=new SberVisor(a)||[]}catch(a){this.config.debug&&i.log(["Ошибка при инициализации SberVisor",a]),window.sberbankIdAnalytics=[]}},a.prototype.submitSberAnalytics=function(a,b,c,d,e,f){var g="js_"+this.getVersion(),h=this.config.sa.clientName||i.getMeta("title"),j=window.location.origin+window.location.pathname;try{var k={eventCategory:a,eventAction:b,eventType:c,properties:{merchUrl:j,merchantTitle:h,sdkVersion:g}};d&&(k.properties.result=d),e&&(k.properties.errorDescription=e),f&&(k.properties=Object.assign({},k.properties,f)),window.sberbankIdAnalytics.push(k)}catch(d){this.config.debug&&i.log(["Ошибка при отправки события ("+a+", "+b+", "+c+") в sber analytics",d])}},a.prototype.fetchFastLoginData=function(){!this.isFastLoginDataFetched&&this.fastLoginIframe&&(i.postMessageToIframe({type:"fetch data"},this.fastLoginIframe.contentWindow),this.isFastLoginDataFetched=!0)},a.prototype.onFastLoginIframeCreateSuccess=function(a){this.config.debug&&i.log(["Iframe для быстрого входа создан",a])},a.prototype.removeLoadDataListener=function(){},a.prototype.loadFastLoginData=function(a,b){this.isFastLoginIframeRegistered&&this.fetchFastLoginData(),this.removeLoadDataListener=i.listenWindowMessages(function(c){switch(c.type){case"iframe is registered":this.fetchFastLoginData();break;case"success":this.config.debug&&i.log(["fast login success",c.data]),this.submitSberAnalytics("Login","sberid_Fast_Login_Auth_Result","Result","success"),a(c.data);break;case"error":this.config.debug&&i.log(["fast login error",c.data]),this.submitSberAnalytics("Login","sberid_Fast_Login_Auth_Result","Result","fail"),b(c.data)}}.bind(this))},a.prototype.createChangeUserBlock=function(a){var b=document.createElement("span"),c=this.theme.padding>34?34:this.theme.padding,d={height:"100%",width:c+"px",display:"flex","align-items":"center","justify-content":"center","border-radius":"0 0 "+this.theme.borderRadius+"px "+this.theme.borderRadius+"px",position:"absolute",right:0,top:0,"z-index":1};b.className="sbid-button-change-user",b.setAttribute("style",i.objToCss(d)),b.setAttribute("data-opened",!1),b.innerHTML='<svg width="4" height="18" viewBox="0 0 4 18" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="white"/><circle cx="2" cy="9" r="2" fill="white"/><circle cx="2" cy="16" r="2" fill="white"/></svg>';var e=document.createElement("span");return e.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle("none","#000014",a))),e.className="sbid-button-change-user__popup",e.innerHTML="Сменить пользователя",e.addEventListener("click",this.onChangeUserLinkClick.bind(this)),b.appendChild(e),b.addEventListener("click",this.onChangeUserPopupToggle),b},a.prototype.getChangeUserErrorBlock=function(a){var b=document.createElement("span");return b.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle("block","#DE4A30",a))),b.className="sbid-button-change-user__error",b.innerHTML="Сервис временно недоступен",b},a.prototype.onChangeUserLinkClick=function(a){return this.submitSberAnalytics("Login","sberid_Change_User_Button_Click","Click"),this.changeUser(a&&a.target),a.preventDefault(),a.stopPropagation(),!1},a.prototype.onChangeUserPopupToggle=function(a){var b=(this.getElementsByClassName("sbid-button-change-user__popup")||[])[0],c=(this.getElementsByClassName("sbid-button-change-user__error")||[])[0];c&&this.removeChild(c);var d=this.parentElement&&this.parentElement.parentElement&&"i-sbid-notification-banner"===this.parentElement.parentElement.id;return b&&("true"===this.dataset.opened?(this.dataset.opened=!1,b.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle()))):(this.dataset.opened=!0,b.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle("block","#000014",d))),i.hideOnClickOutside(b,function(){this.dataset.opened=!1,b.setAttribute("style",i.objToCss(i.getChangeUserPopupStyle()))}.bind(this)))),a.preventDefault(),a.stopPropagation(),!1},a.prototype.fastLogin=function(a,b){var c=i.buildUrl("",this.oidcParams),d=this.config.baseUrl+"/CSAFront/oidc/authorizelow.do?prompt=none&"+c;this.isFastLoginIframeRegistered=!1,this.isFastLoginDataFetched=!1,this.fastLoginIframe=i.createIframe(d,"sberid-iframe",this.onFastLoginIframeCreateSuccess.bind(this),b.bind(this)),document.body.append(this.fastLoginIframe);var e=setTimeout(function(){b({type:"timeout",description:"Ошибка при создании iframe"})},this.config.fastLogin.timeout,this),f=i.listenWindowMessages(function(c){switch(c.type){case"iframe is registered":clearTimeout(e),this.isFastLoginIframeRegistered=!0,this.loadFastLoginData(a,b),f()}}.bind(this))},a.prototype.destroyFastLogin=function(){this.config.debug&&i.log(["Iframe удален"]),this.fastLoginIframe&&this.fastLoginIframe.remove(),this.removeLoadDataListener&&this.removeLoadDataListener(),this.isFastLoginIframeRegistered=!1,this.isFastLoginDataFetched=!1},a}();Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a,b){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(void 0!==e&&null!==e)for(var f=Object.keys(Object(e)),g=0,h=f.length;g<h;g++){var i=f[g],j=Object.getOwnPropertyDescriptor(e,i);void 0!==j&&j.enumerable&&(c[i]=e[i])}}return c}}),a.SberidSDK=z}("object"==typeof exports&&exports||this);